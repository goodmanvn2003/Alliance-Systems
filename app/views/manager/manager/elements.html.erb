<%
   # Initializers
   @isVersioning = @enginesFlags.has_key?('CompliancePlugin') ? (@enginesFlags['CompliancePlugin']['status']['versioning'] == "yes") : false
   @isCompliance = @enginesFlags.has_key?('CompliancePlugin') ? (@enginesFlags['CompliancePlugin']['status']['compliance'] == "yes") : false
%>
<!-- meta create modal -->
<div id="metatagCreate" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <h3 id="myModalLabel">Create Metatag</h3>
  </div>
  <div class="modal-body">
    <div class="row-fluid">
      <div class="span2">Name</div>
      <div class="span8"><input id="metatagCreate_name" type="text" style="width:96%;" placeholder="unique name" maxlength="32" /></div>
    </div>
    <div class="row-fluid">
      <div class="span2">Content</div>
      <div class="span8"><textarea id="metatagCreate_content" rows="15" style="width:96%;font-family:'Courier New',sans-serif;" placeholder="should not be left blank"></textarea></div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true" id="metatagCloseBtn">Close</button>
    <button id="metatagCreateBtnCreate" class="btn btn-primary" data-dismiss="modal" id="metatagCreateBtn" onclick="createMetatag()" disabled="disabled">Create</button>
  </div>
</div>
<!-- -->

<!-- meta delete modal -->
<div id="metatagDelete" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Delete Metatag</h3>
  </div>
  <div class="modal-body">
    <p id="metatagDeleteMsg" style="display:none;">Are you sure you want to do this?</p>
    <p id="metatagDeleteInvalidMsg" style="display:none;">No selections yet!</p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button id="metatagDeleteButton" class="btn btn-primary" data-dismiss="modal" onclick="deleteMetatag()">Delete</button>
  </div>
</div>
<!-- -->

<!-- placeholder create modal -->
<div id="placeholderCreate" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <h3 id="myModalLabel">Create Placeholder</h3>
  </div>
  <div class="modal-body">
   	<div class="row-fluid">
    	<div class="span2">Name</div>
    	<div class="span8"><input id="placeholderCreate_name" type="text" style="width:96%;" placeholder="unique name" maxlength="32" /></div>
    </div>
    <div class="row-fluid">
    	<div class="span2">Content</div>
    	<div class="span8"><textarea id="placeholderCreate_content" rows="15" style="width:96%;font-family:'Courier New',sans-serif;" placeholder="should not be left blank"></textarea></div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true" id="placeholderCloseBtn">Close</button>
    <button id="placeholderCreateBtnCreate" class="btn btn-primary" data-dismiss="modal" id="placeholderCreateBtn" onclick="createPlaceholder()" disabled="disabled">Create</button>
  </div>
</div>
<!-- -->

<!-- script create modal -->
<div id="scriptCreate" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <h3 id="myModalLabel">Create Script</h3>
  </div>
  <div class="modal-body">
   	<div class="row-fluid">
    	<div class="span2">Name</div>
    	<div class="span8"><input id="scriptCreate_name" type="text" style="width:96%;" placeholder="unique name" maxlength="32" /></div>
    </div>
    <div class="row-fluid">
    	<div class="span2">Content</div>
    	<div class="span8"><textarea id="scriptCreate_content" rows="15" style="width:96%;font-family:'Courier New',sans-serif;" placeholder="should not be left blank"></textarea></div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true" id="scriptCloseBtn">Close</button>
    <button id="scriptCreateBtnCreate" class="btn btn-primary" data-dismiss="modal" id="scriptCreateBtn" onclick="createScript()" disabled="disabled">Create</button>
  </div>
</div>
<!-- -->


<!-- placeholder delete modal -->
<div id="placeholderDelete" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Delete Placeholder</h3>
  </div>
  <div class="modal-body">
    <p id="placeholderDeleteMsg" style="display:none;">Are you sure you want to do this?</p>
    <p id="placeholderDeleteInvalidMsg" style="display:none;">No selections yet!</p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button id="placeholderDeleteButton" class="btn btn-primary" data-dismiss="modal" onclick="deletePlaceholder()">Delete</button>
  </div>
</div>
<!-- -->

<!-- script delete modal -->
<div id="scriptDelete" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Delete Script</h3>
  </div>
  <div class="modal-body">
    <p id="scriptDeleteMsg" style="display:none;">Are you sure you want to do this?</p>
    <p id="scriptDeleteInvalidMsg" style="disiplay:none;">No selections yet!</p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button id="scriptDeleteButton" class="btn btn-primary" data-dismiss="modal" onclick="deleteScript()">Delete</button>
  </div>
</div>
<!-- -->

<!-- template create modal -->
<div id="templateCreate" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <h3 id="myModalLabel">Create Template</h3>
  </div>
  <div class="modal-body">
    <div class="row-fluid">
    	<div class="span2">Name</div>
    	<div class="span8"><input id="templateCreate_name" type="text" style="width:96%;" placeholder="unique name" maxlength="32" /></div>
    </div>
    <div class="row-fluid">
    	<div class="span2">Content</div>
    	<div class="span8"><textarea id="templateCreate_content" rows="15" style="width:96%;" style="font-family:'Courier New',sans-serif;" placeholder="should not be left blank"></textarea></div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true" id="templateCloseBtn">Close</button>
    <button id="templateCreateBtnCreate" class="btn btn-primary" data-dismiss="modal" id="templateCreateBtn" onclick="createTemplate()" disabled="disabled">Create</button>
  </div>
</div>
<!-- -->

<!-- template delete modal -->
<div id="templateDelete" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Delete Template</h3>
  </div>
  <div class="modal-body">
    <p id="templateDeleteMsg" style="display:none;">Are you sure you want to do that?</p>
    <p id="templateDeleteInvalidMsg" style="display:none;">No selections yet!</p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button id="templateDeleteButton" class="btn btn-primary" data-dismiss="modal" onclick="deleteTemplate()">Delete</button>
  </div>
</div>
<!-- -->

<!-- Code Compare Modal -->

<div id="codeCompareModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Revision Comparison</h3>
  </div>
  <div class="modal-body">
    <div id="codeCompareModalBody" style="display:none;">
      <div style="display:block;overflow:hidden;margin:10px 0 10px 0;">
        <div style="float:left;font-weight:bold;">Current Content</div>
        <div style="float:right;font-weight:bold;"><span id="codeCompareModalOtherVersion"></span></div>
      </div>
      <div id="compareView">
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary" id="codeCompareModalRevertBtn">revert to this revision</button>
  </div>
</div>

<!-- End of modal section -->

<div class="container" style="margin-bottom: 25px;">
	<div class="">
		<div class="row-fluid">
  			<div class="span3">
                <div id="elementsList">
                    <ul id="metatagList" class="nav nav-list">
                        <li class="nav-header">Metatags<span style="margin-left:10px;"><a class="metatagCreate" href="#metatagCreate" data-toggle="modal" data-backdrop="static" data-keyboard="false">+</a></span><span style="margin-left:10px;"><a class="metatagDelete" href="#metatagDelete" data-toggle="modal">-</a></span><span style="margin-left:10px;"><a id="aMetaElementToggleVisibility" href="javascript:toggleMetatagVisibility()">h</a></span></li>
                        <% @metas.each do |t| %>
                            <li class="listItemMeta"><a href="javascript:void(0);" onclick="showContent(this,'<%= t['key'].html_safe %>','meta');" data-id="<%= t['id'].to_s.html_safe %>"><%= t['key'].html_safe %></a></li>
                        <% end %>
                    </ul>
                    <ul id="placeholderList" class="nav nav-list">
                        <li class="nav-header">Placeholders<span style="margin-left:10px;"><a class="placeholderCreate" href="#placeholderCreate" data-toggle="modal" data-backdrop="static" data-keyboard="false">+</a></span><span style="margin-left:10px;"><a class="placeholderDelete" href="#placeholderDelete" data-toggle="modal">-</a></span><span style="margin-left:10px;"><a id="aItemElementToggleVisibility" href="javascript:togglePlaceholderVisbility()">h</a></span></li>
                        <% @layouts.each do |t| %>
                            <li class="listItemElement"><a href="javascript:void(0);" onclick="showContent(this,'<%= t['key'].html_safe %>','element');" data-id="<%= t['id'].to_s.html_safe %>"><%= t['key'].html_safe %></a></li>
                        <% end %>
                    </ul>
                    <ul id="scriptList" class="nav nav-list">
                        <li class="nav-header">Scripts<span style="margin-left:10px;"><a class="scriptCreate" href="#scriptCreate" data-toggle="modal" data-backdrop="static" data-keyboard="false">+</a></span><span style="margin-left:10px;"><a class="scriptDelete" href="#scriptDelete" data-toggle="modal">-</a></span><span style="margin-left:10px;"><a id="aScriptToggleVisibility" href="javascript:toggleScriptVisibility()">h</a></span></li>
                        <% @rubies.each do |t| %>
                            <li class="listItemScript"><a href="javascript:void(0);" onclick="showContent(this,'<%= t['key'].html_safe %>','script');" data-id="<%= t['id'].to_s.html_safe %>"><%= t['key'].html_safe %></a></li>
                        <% end %>
                    </ul>
                    <ul id="templateList" class="nav nav-list">
                        <li class="nav-header">Templates<span style="margin-left:10px;"><a class="templateCreate" href="#templateCreate" data-toggle="modal" data-backdrop="static" data-keyboard="false">+</a></span><span style="margin-left:10px;"><a class="templateDelete" href="#templateDelete" data-toggle="modal">-</a></span><span style="margin-left:10px;"><a id="aTemplateToggleVisibility" href="javascript:toggleTemplateVisibility()">h</a></span></li>
                        <% @pages.each do |t| %>
                            <li class="listItemTemplate"><a href="javascript:void(0);" onclick="showContent(this,'<%= t['key'].html_safe %>','template');" data-id="<%= t['id'].to_s.html_safe %>"><%= t['key'].html_safe %></a></li>
                        <% end %>
                    </ul>
                </div>

              <% if (@isVersioning) %>
                  <!-- Item history section -->
                  <div class="historyWidget" data-page="0" style="margin-top:16px;">
                    <ul id="historyList" class="nav nav-list historyList" style="overflow:hidden;">
                      <li class="nav-header">Changes</li>
                      <!--<li style="font-size:12px;"><i class="icon-pencil"></i>&nbsp;<span>Anh Nguyen</span>&nbsp;(<span>1 hour ago</span>)</li>
                      <li style="font-size:12px;"><i class="icon-pencil"></i>&nbsp;<span>Anh Nguyen</span>&nbsp;(<span>2 days ago</span>)</li>-->
                    </ul>
                    <div style="overflow:hidden;padding-left:15px;padding-right:15px;">
                      <div style="font-size:12px;display:none;float:left;margin-right:5px;" class="historyNext"><a href="javascript:void(0);" id="historyListNext"><i class="icon-chevron-right"></i>&nbsp;next</a></div>
                      <div style="font-size:12px;display:none;float:left;"  class="historyPrev"><a href="javascript:void(0);" id="historyListPrev"><i class="icon-chevron-left"></i>&nbsp;prev</a></div>
                      <div style="font-size:12px;float:right;" class="historyPage"></div>
                    </div>
                  </div>
                  <!-- Item history section -->
              <% end %>

            </div>
  			<div class="span9" style="min-height:512px;">
                  <div id="meta" class="elementItem hidden">
                    <div>
                      <div class="row-fluid">
                        <div style="overflow:hidden;">
                          <div style="float:left;">
                            <h4>Meta Code</h4>
                            <% if (@isVersioning) %>
                                <div style="margin:-8px 0 16px 0;font-size:12px;">
                                  <span id="versionNumberPage_meta"><i class="icon-check"></i>&nbsp;current</span>&nbsp;<span id="switchToCurrentPage" style="display:none;">(<a href="javascript:void(0);" class="switchToCurrentPage">switch to current</a>)</span>
                                </div>
                                <% end %>
                          </div>
                          <div style="float:right;">
                            <button id="metaSaveBtn" class="btn btn-primary">save</button>
                          </div>
                        </div>

                        <div style="text-align:left;">
                          <textarea id="tplMetaCode" rows="20" style="width:97%;text-align:left;font-family:'Courier New',sans-serif;">
                          </textarea>
                        </div>
                      </div>
                    </div>
                  </div>

  				<div id="element" class="elementItem hidden">
  					<div>
  						<div class="row-fluid">
                            <% if (defined?(AlliancePodioPlugin)) %>
  							<div class="span1" style="padding:5px;">Podio Apps</div>
					  		<div id="appLabels" class="span10" style="padding:5px;">

					  		</div>
                            <% end %>
  						</div>
						<div class="row-fluid">
							<div style="overflow:hidden;">
								<div style="float:left;">
									<h4>Raw HTML Code</h4>
                                  <% if (@isVersioning) %>
                                          <div style="margin:-8px 0 16px 0;font-size:12px;">
                                            <span id="versionNumberPage_placeholder"><i class="icon-check"></i>&nbsp;current</span>&nbsp;<span id="switchToCurrentPage" style="display:none;">(<a href="javascript:void(0);" class="switchToCurrentPage">switch to current</a>)</span>
                                          </div>
                                      <% end %>
								</div>
								<div style="float:right;">
                                    <button class="cCodeCleanupBtn btn">reformat code</button>
  									<button id="elementSaveBtn" class="btn btn-primary">save</button>
  								</div>
							</div>
							
  							<div style="text-align:left;">
  								<textarea id="tplElementHtmlCode" rows="20" style="width:97%;text-align:left;font-family:'Courier New',sans-serif;">
  								</textarea>
  							</div>
						</div>
  					</div>
  				</div>
  				
  				<div id="script" class="elementItem hidden">
  					<div>
  						<div class="row-fluid">
							<div style="overflow:hidden;">
								<div style="float:left;">
									<h4>Raw Ruby Code</h4>
                                  <% if (@isVersioning) %>
                                      <div style="margin:-8px 0 16px 0;font-size:12px;">
                                        <span id="versionNumberPage_ruby"><i class="icon-check"></i>&nbsp;current</span>&nbsp;<span id="switchToCurrentPage" style="display:none;">(<a href="javascript:void(0);" class="switchToCurrentPage">switch to current</a>)</span>
                                      </div>
                                  <% end %>
								</div>
								<div style="float:right;">
                                    <button class="cCodeCleanupBtn btn">reformat code</button>
  									<button id="scriptSaveBtn" class="btn btn-primary">save</button>
  								</div>
							</div>
							
  							<div style="text-align:left;">
  								<textarea id="tplScriptRubyCode" rows="20" style="width:97%;text-align:left;font-family:'Courier New',sans-serif;">
  								</textarea>
  							</div>
						</div>
  					</div>
  				</div>
  				
  				<div id="template" class="elementItem hidden">
  					<div>
  						<div class="row-fluid">
  							<div class="span1" style="padding:5px;">Styles</div>
					  		<div id="styleLabels" class="span11" style="padding:5px;">
						  		<% @css.each do |c| %>
						  			<span class="label" data-id="<%= c.id.to_s %>"><%= c.key.strip.html_safe %></span>
						  		<% end %>
					  		</div>
  						</div>
  						<div class="row-fluid">
  							<div class="span1" style="padding:5px;">Scripts</div>
					  		<div id="scriptLabels" class="span11" style="padding:5px;">
					  			<% @js.each do |j| %>
						  			<span class="label" data-id="<%= j.id.to_s %>"><%= j.key.strip.html_safe %></span>
						  		<% end %>
					  		</div>
  						</div>
  						<div class="row-fluid">
  							<div class="span1" style="padding:5px;">Meta</div>
					  		<div id="metaLabels" class="span11" style="padding:5px;">
					  			<% @metas.each do |m| %>
						  			<span class="label" data-id="<%= m.id.to_s %>"><%= m.key.strip.html_safe %></span>
						  		<% end %>
					  		</div>
  						</div>
						<div class="row-fluid">
							<div style="overflow:hidden;">
								<div style="float:left;">
									<h4>Raw HTML Code</h4>
                                  <% if (@isVersioning) %>
                                        <div style="margin:-8px 0 16px 0;font-size:12px;">
                                          <span id="versionNumberPage_template"><i class="icon-check"></i>&nbsp;current</span>&nbsp;<span id="switchToCurrentPage" style="display:none;">(<a href="javascript:void(0);">switch to current</a>)</span>
                                        </div>
                                    <% end %>
								</div>
								<div style="float:right;">
                                    <button class="cCodeCleanupBtn btn">reformat code</button>
  									<button id="templateSaveBtn" class="btn btn-primary">save</button>
  								</div>
							</div>
  							<div style="text-align:left;">
  								<textarea id="tplHtmlCode" rows="20" style="width:97%;text-align:left;font-family:'Courier New',sans-serif;">
  								</textarea>
  							</div>
						</div>
  					</div>
  				</div>

  			</div>
		</div>
	</div>
</div>

<%= javascript_include_tag "manager/elements" %>